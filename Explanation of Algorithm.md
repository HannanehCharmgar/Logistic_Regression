# الگوریتم رگرسیون لجستیک (Logistic Regression)


---

## رگرسیون لجستیک چیست؟

رگرسیون لجستیک (Logistic Regression) یک الگوریتم **یادگیری نظارت‌شده (Supervised Learning)** است که برای **مسائل طبقه‌بندی دودویی (Binary Classification)** استفاده می‌شود.  
هدف این الگوریتم، پیش‌بینی **احتمال تعلق یک نمونه به کلاس مثبت (Class 1)** است.

برخلاف رگرسیون خطی که خروجی عددی پیوسته تولید می‌کند،  
رگرسیون لجستیک خروجی خود را به صورت **احتمال بین 0 و 1** ارائه می‌دهد و سپس با استفاده از یک آستانه (Threshold)، تصمیم نهایی طبقه‌بندی را می‌گیرد.

ویژگی مهم این الگوریتم:
- ساده
- قابل تفسیر
- سریع
- بسیار پرکاربرد در مسائل پزشکی، مالی و تصمیم‌گیری‌های باینری

---

## مرحله ۱: تعریف مسئله (Problem Definition)

ما با یک مسئله **طبقه‌بندی دودویی** طرف هستیم.

مثال:
- آیا بیمار دیابت دارد؟ → 1  
- یا دیابت ندارد؟ → 0  

خروجی فقط دو مقدار ممکن دارد و پیوسته نیست.

---

## مرحله ۲: داده‌ها و Featureها

### ویژگی (feature) چیست؟

یعنی هر اطلاعاتی که از یک داده می‌گیریم تا مدل باهاش تصمیم بگیره.

مثال در دیتاست دیابت:
- Glucose
- BMI
- Age
- BloodPressure

هر سطر داده نشان‌دهنده یک فرد و هر ستون یک Feature است.

---

## مرحله ۳: ترکیب خطی Featureها (Linear Combination)

در ابتدا، رگرسیون لجستیک مانند رگرسیون خطی عمل می‌کندم:

z = w1x1 + w2x2 + ... + wnxn + b

که در آن:
- متغیر x = ویژگی ها ( features ) 
- متغیر w = اهمیت feature ها ( وزن ها) 
- متغیرb = بایاس مدل است.

خروجی این مرحله می‌تواند هر عددی باشد (منفی یا مثبت).

---

## مرحله ۴: مشکل خروجی خطی

مقادیر خطی مانند:
- z = 6.4
- z = -3.2

ما با عدد 6.4 نمیتوانیم متوجه شیم فرد دیابت دارد یا خیر و قابل تفسیر به عنوان «احتمال» نیستند چون ما نیاز داریم خروجی مدل به عددی بین 0 و 1 تبدیل شود.

---

## مرحله ۵: تابع سیگموئید (Sigmoid Function)

تابع سیگموئید هسته اصلی رگرسیون لجستیک است.

فرمول:
σ(z) = 1 / (1 + e^(-z))

این تابع هر عددی را به بازه [0, 1] نگاشت می‌کند.

[
![Sigmoid Function](https://upload.wikimedia.org/wikipedia/commons/8/88/Logistic-curve.svg)](https://media.licdn.com/dms/image/v2/D4D12AQGIXdSG7IJCNw/article-cover_image-shrink_600_2000/article-cover_image-shrink_600_2000/0/1694183259537?e=2147483647&t=lJ_qEzot0iGYhNpez9XGRNHjS-CDKHn3Wj-6iCQxRO0&v=beta)

تفسیر:
- z = خیلی منفی → خروجی نزدیک 0
- z = 0 → خروجی 0.5
- z = خیلی مثبت → خروجی نزدیک 1

---

## مرحله ۶: تفسیر خروجی مدل

خروجی مدل اکنون یک **احتمال** است.

مثال:
P(y=1) = 0.78

یعنی:
این فرد با احتمال 78٪ به کلاس مثبت (مثلاً بیمار) تعلق دارد.

---

## مرحله ۷: آستانه تصمیم (Decision Threshold)

برای تبدیل احتمال به کلاس نهایی:

اگر p ≥ 0.5 → کلاس 1  
اگر p < 0.5 → کلاس 0  

آستانه 0.5 رایج است، اما قابل تغییر است.

تصویر پیشنهادی:
![Threshold Decision](https://miro.medium.com/v2/resize:fit:1200/1*HxcqI2h5n8M0nQX6Ff6Wjw.png)

در پزشکی معمولاً آستانه پایین‌تر انتخاب می‌شود تا بیماران بیشتری شناسایی شوند.

---

## مرحله ۸: تابع هزینه (Log Loss)

برای یادگیری مدل از تابع هزینه Cross-Entropy استفاده می‌شود:

Loss = -[y log(p) + (1-y) log(1-p)]

ویژگی مهم:
- پیش‌بینی اشتباه با اطمینان بالا → جریمه سنگین
- پیش‌بینی درست → جریمه کم

تصویر پیشنهادی:
![Log Loss](https://ml-cheatsheet.readthedocs.io/en/latest/_images/log_loss.png)

---

## مرحله ۹: بهینه‌سازی (Optimization)

مدل با استفاده از روش‌هایی مانند:
- Gradient Descent
- Solverهای عددی

وزن‌ها (w) و بایاس (b) را طوری تنظیم می‌کند که تابع هزینه کمینه شود.

---

## مرحله ۱۰: ماتریس سردرگمی (Confusion Matrix)

پس از آموزش، عملکرد مدل بررسی می‌شود.

| وضعیت واقعی | پیش‌بینی مدل |
|------------|-------------|
| TP | بیمار → بیمار |
| TN | سالم → سالم |
| FP | سالم → بیمار |
| FN | بیمار → سالم |

تصویر پیشنهادی:
![Confusion Matrix](https://scikit-learn.org/stable/_images/sphx_glr_plot_confusion_matrix_001.png)

در پزشکی، FN خطرناک‌ترین خطاست.

---

## مرحله ۱۱: معیارهای ارزیابی

- Accuracy: دقت کلی
- Precision: دقت پیش‌بینی‌های مثبت
- Recall: توانایی یافتن بیماران واقعی
- F1-score: تعادل Precision و Recall

تصویر پیشنهادی:
![Precision Recall](https://upload.wikimedia.org/wikipedia/commons/6/6b/Precisionrecall.svg)

---

## مرحله ۱۲: تفسیر ضرایب مدل

- ضریب مثبت → افزایش احتمال کلاس 1
- ضریب منفی → کاهش احتمال کلاس 1

این ویژگی باعث می‌شود رگرسیون لجستیک **قابل توضیح (Explainable)** باشد.

تصویر پیشنهادی:
![Coefficients](https://miro.medium.com/v2/resize:fit:1200/1*8dXyKqV7R5ZtPFl1kYyqMw.png)

---

## مرحله ۱۳: جمع‌بندی نهایی

رگرسیون لجستیک:
1. Featureها را وزن‌دهی می‌کند
2. خروجی خطی می‌سازد
3. با سیگموئید → احتمال تولید می‌کند
4. با آستانه → تصمیم نهایی می‌گیرد

در یک جمله:
**رگرسیون لجستیک = تبدیل عدد به احتمال و سپس تصمیم منطقی**
